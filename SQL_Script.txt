CREATE TABLE company(
        id SERIAL PRIMARY KEY,
        name VARCHAR NOT NULL UNIQUE,
        headquarters VARCHAR,
        established_year INTEGER,
        ceo VARCHAR
);

INSERT INTO company(name, headquarters, established_year, ceo) VALUES
        ('Apple', 'California, US', 1976, 'Tim Cook'),
        ('Amazon', 'Washington, US', 1994, 'Andy Jassy'),
        ('Alphabet', 'California, US', 2015, 'Sundar Pichai'),
        ('Microsoft', 'Washington, US', 1975, 'Satya Nadella'),
        ('Tencent', 'Shenzhen, China', 1998, 'Ma Huateng'),
        ('Meta', 'California, US', 2004, 'Mark Zuckerberg'),
        ('TSMC', 'Hsinchu, Taiwan', 1987, 'C.C.Wei'),
        ('Nvidia', 'California, US', 1993, 'Jensen Huang'),
        ('Salesforce', 'California, US', 1999, 'Marc Benioff'),
        ('IBM', 'New York, US', 1911, 'Arvind Krishna')
;

ALTER TABLE company 
	ADD industry VARCHAR(20) 
	DEFAULT 'tech'
;

UPDATE company 
	SET industry = 'Consumer electronics' 
	WHERE name = 'Apple'
;	

SELECT * FROM company 
	ORDER BY id
;

SELECT * FROM company 
	ORDER BY established_year DESC
;

SELECT id, name AS most_recently_established, headquarters, established_year, ceo, industry
	FROM company
	WHERE established_year = (SELECT MAX(established_year) FROM company)
;

SELECT ceo, established_year 
	FROM company 
	WHERE name LIKE 'M%'
	ORDER BY established_year DESC
;

SELECT name, ceo, established_year 
	FROM company 
	WHERE industry = 'tech' AND headquarters LIKE '%US'
	ORDER BY established_year
;

SELECT headquarters, COUNT(headquarters) AS number_of_companies_based_here
	FROM company 
	WHERE industry = 'tech' AND headquarters LIKE '%US'
	GROUP BY headquarters
	HAVING COUNT(headquarters) > 1
;

DROP TABLE company;